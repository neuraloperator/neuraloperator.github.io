<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>neuralop.losses.H1Loss &#8212; neuraloperator 1.0.2 documentation</title> 
<link rel="stylesheet" href="../../_static/tensorly_style.css">
<link rel="apple-touch-icon" sizes="180x180" href="../../_static/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../_static/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../_static/favicon/favicon-16x16.png">
<link rel="manifest" href="../../_static/favicon/site.webmanifest">
<link rel="mask-icon" href="../../_static/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../../_static/favicon/favicon.ico">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/tensorly_style.css?v=a02e9698" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
    <script src="../../_static/documentation_options.js?v=1ed6394b"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
 <script src="../../_static/navbar_burger.js"></script>
 <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
 
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="neuralop.data.datasets.load_darcy_flow_small" href="neuralop.data.datasets.load_darcy_flow_small.html" />
    <link rel="prev" title="neuralop.losses.LpLoss" href="neuralop.losses.LpLoss.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  </head>
<body  class="has-navbar-fixed-top">

  <header>
    <navbar>
      <nav class="navbar top-navbar is-fixed-top has-shadow is-flex-wrap-wrap" role="navigation" aria-label="main top navigation">
        <div class="navbar-brand">
        

          <a class="navbar-item" href="../../index.html">
            <img src="../../_static/neuraloperator_logo.png" height="28">
          </a>
          <a class="navbar-item is-hidden-desktop" href="https://github.com/neuraloperator/neuraloperator" target="_blank">
              <span class="icon"><i class="fab fa-github"></i></span>
          </a>

          <a role="button" class="navbar-burger" data-target="top-nav-menu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>

        </div>
        
        <div class="navbar-menu" id="top-nav-menu">
        

          <div class="navbar-start">
            
              <a class="navbar-item" href="../../install.html">
              Install
            </a>
              <a class="navbar-item" href="../../user_guide/index.html">
              User Guide
            </a>
              <a class="navbar-item" href="../api.html">
              API
            </a>
              <a class="navbar-item" href="../../auto_examples/index.html">
              Examples
            </a>
          </div>
        
          <div class="navbar-end">
            <div class="navbar-item">
            
            <a class="button is-hidden-touch is-dark" href="https://github.com/neuraloperator/neuraloperator" target="_blank">
              <span class="icon-text">
                <span class="icon is-large">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </span>
            </a>

            </div> 
          </div> 
        </div> 

      </nav>
      
    </navbar>
  </header>


  <div id="column-container">
  <div class="columns is-mobile is-centered">
	
  
      <div class="column is-10-mobile is-one-third-tablet is-3-desktop is-hidden-mobile" id="sidebar">
    
    <aside class="sticky-nav sidebar-menu">
<div class="sidebar-search">
  <form class="field" id="searchbox" role="search" action="../../search.html" method="get">
    <!-- <label class="label" id="searchlabel">Quick search</label> -->
    <div class="field has-addons">
      <div class="control is-expanded">
        <input class="input" type="text" placeholder="Search the doc" name="q" aria-labelledby="searchlabel autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      </div>
      <div class="control">
        <input class="button is-info" type="submit" value="Go" />
      </div>
    </div>
  </form>
  <script>document.getElementById('searchbox').style.display = "block"</script>

</div>
      
      <div class="sidebar-menu-toc">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing NeuralOperator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">NeuralOperator User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-neuralop.layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#model-dispatching">Model Dispatching</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#data">Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Gallery of examples</a></li>
</ul>
 
      </div>
    </aside>
  </div>
  

  <div class="column main-column">

    
    <div class="main-section">

      
      
      <div class="side-menu-toggle">
        <button class="button" id="toggle-sidebar" onclick="toggle_sidebar()">
          <span class="icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
          <span>menu</span> 
        </button>
      </div>
      

      <div class="container content main-content">
        
  <section id="neuralop-losses-h1loss">
<h1><a class="reference internal" href="../api.html#module-neuralop.losses" title="neuralop.losses"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.losses</span></code></a>.H1Loss<a class="headerlink" href="#neuralop-losses-h1loss" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="neuralop.losses.H1Loss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralop.losses.</span></span><span class="sig-name descname"><span class="pre">H1Loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_x_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_y_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_z_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/losses/data_losses.html#H1Loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.H1Loss" title="Link to this definition"></a></dt>
<dd><p>H1Loss provides the H1 Sobolev norm between
two d-dimensional discretized functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In function space, the Sobolev norm is an integral over the
entire domain. To ensure the norm converges to the integral,
we scale the matrix norm by quadrature weights along each spatial dimension.</p>
<p>If no quadrature is passed at a call to H1Loss, we assume a regular 
discretization and take <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">measure</span></code> as the quadrature weights.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>d</strong><span class="classifier">int, optional</span></dt><dd><p>dimension of input functions, by default 1</p>
</dd>
<dt><strong>measure</strong><span class="classifier">float or list, optional</span></dt><dd><p>measure of the domain, by default 1.0
either single scalar for each dim, or one per dim</p>
<p>To perform quadrature, <code class="docutils literal notranslate"><span class="pre">H1Loss</span></code> scales <code class="docutils literal notranslate"><span class="pre">measure</span></code> by the size
of each spatial dimension of <code class="docutils literal notranslate"><span class="pre">x</span></code>, and multiplies them with 
||x-y||, such that the final norm is a scaled average over the spatial
dimensions of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt><strong>reduction</strong><span class="classifier">str, optional</span></dt><dd><p>whether to reduce across the batch and channel dimension
by summing (‘sum’) or averaging (‘mean’)</p>
</dd>
<dt><strong>fix_x_bnd</strong><span class="classifier">bool, optional</span></dt><dd><p>whether to fix finite difference derivative
computation on the x boundary, by default False</p>
</dd>
<dt><strong>fix_y_bnd</strong><span class="classifier">bool, optional</span></dt><dd><p>whether to fix finite difference derivative
computation on the y boundary, by default False</p>
</dd>
<dt><strong>fix_z_bnd</strong><span class="classifier">bool, optional</span></dt><dd><p>whether to fix finite difference derivative
computation on the z boundary, by default False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>name</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(y_pred, y[, quadrature])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuralop.losses.H1Loss.abs" title="neuralop.losses.H1Loss.abs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abs</span></code></a>(x, y[, quadrature])</p></td>
<td><p>absolute H1 norm</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuralop.losses.H1Loss.compute_terms" title="neuralop.losses.H1Loss.compute_terms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_terms</span></code></a>(x, y, quadrature)</p></td>
<td><p>compute_terms computes the necessary finite-difference derivative terms for computing the H1 norm</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuralop.losses.H1Loss.reduce_all" title="neuralop.losses.H1Loss.reduce_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduce_all</span></code></a>(x)</p></td>
<td><p>reduce x across the batch according to <cite>self.reduction</cite></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuralop.losses.H1Loss.rel" title="neuralop.losses.H1Loss.rel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rel</span></code></a>(x, y[, quadrature])</p></td>
<td><p>relative H1-norm</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuralop.losses.H1Loss.uniform_quadrature" title="neuralop.losses.H1Loss.uniform_quadrature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uniform_quadrature</span></code></a>(x)</p></td>
<td><p>uniform_quadrature creates quadrature weights scaled by the spatial size of <code class="docutils literal notranslate"><span class="pre">x</span></code> to ensure that  <code class="docutils literal notranslate"><span class="pre">LpLoss</span></code> computes the average over spatial dims.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="neuralop.losses.H1Loss.compute_terms">
<span class="sig-name descname"><span class="pre">compute_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/losses/data_losses.html#H1Loss.compute_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.H1Loss.compute_terms" title="Link to this definition"></a></dt>
<dd><p>compute_terms computes the necessary
finite-difference derivative terms for computing
the H1 norm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">torch.Tensor</span></dt><dd><p>inputs</p>
</dd>
<dt><strong>y</strong><span class="classifier">torch.Tensor</span></dt><dd><p>targets</p>
</dd>
<dt><strong>quadrature</strong><span class="classifier">int or list</span></dt><dd><p>quadrature weights</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralop.losses.H1Loss.uniform_quadrature">
<span class="sig-name descname"><span class="pre">uniform_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/losses/data_losses.html#H1Loss.uniform_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.H1Loss.uniform_quadrature" title="Link to this definition"></a></dt>
<dd><p>uniform_quadrature creates quadrature weights
scaled by the spatial size of <code class="docutils literal notranslate"><span class="pre">x</span></code> to ensure that 
<code class="docutils literal notranslate"><span class="pre">LpLoss</span></code> computes the average over spatial dims.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">torch.Tensor</span></dt><dd><p>input data</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>quadrature</strong><span class="classifier">list</span></dt><dd><p>list of quadrature weights per-dim</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralop.losses.H1Loss.reduce_all">
<span class="sig-name descname"><span class="pre">reduce_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/losses/data_losses.html#H1Loss.reduce_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.H1Loss.reduce_all" title="Link to this definition"></a></dt>
<dd><p>reduce x across the batch according to <cite>self.reduction</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralop.losses.H1Loss.abs">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/losses/data_losses.html#H1Loss.abs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.H1Loss.abs" title="Link to this definition"></a></dt>
<dd><p>absolute H1 norm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">torch.Tensor</span></dt><dd><p>inputs</p>
</dd>
<dt><strong>y</strong><span class="classifier">torch.Tensor</span></dt><dd><p>targets</p>
</dd>
<dt><strong>quadrature</strong><span class="classifier">float or list, optional</span></dt><dd><p>quadrature constant for reduction along each dim, by default None</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralop.losses.H1Loss.rel">
<span class="sig-name descname"><span class="pre">rel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/losses/data_losses.html#H1Loss.rel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.H1Loss.rel" title="Link to this definition"></a></dt>
<dd><p>relative H1-norm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">torch.Tensor</span></dt><dd><p>inputs</p>
</dd>
<dt><strong>y</strong><span class="classifier">torch.Tensor</span></dt><dd><p>targets</p>
</dd>
<dt><strong>quadrature</strong><span class="classifier">float or list, optional</span></dt><dd><p>quadrature constant for reduction along each dim, by default None</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="clearer"></div></section>


      </div>

      
        <nav class="pagination" role="navigation" aria-label="pagination">
    
    <a class="button pagination-previous" href="neuralop.losses.LpLoss.html" title="previous page" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.losses</span></code>.LpLoss</span>
    </a>
    
    
    <a class="button pagination-next" href="neuralop.data.datasets.load_darcy_flow_small.html" title="next page" accesskey="n">
        <span><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.data.datasets</span></code>.load_darcy_flow_small </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

      

        <footer class="footer">
    <div class="content has-text-centered">
        <div class="block">
          &copy; Copyright 2025, Jean Kossaifi, David Pitt, Nikola Kovachki, Zongyi Li and Anima Anandkumar.<br/>
        </div>
    </div>
  </footer>

    </div>

  </div>  

	
    
    <div class="column is-hidden-touch is-2-desktop is-one-fifth-widescreen" id="localtoc-column">

    <aside class="sticky-nav localtoc"> 
        <p class="menu-label"> 
            <span class="icon-text">
                <span class="icon"><i class="fas fa-duotone fa-list"></i></span>
                <span> On this page </span>
            </span>
        </p>

        <div class="menu menu-list localtoc-list">
        <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.losses</span></code>.H1Loss</a><ul>
<li><a class="reference internal" href="#neuralop.losses.H1Loss"><code class="docutils literal notranslate"><span class="pre">H1Loss</span></code></a><ul>
<li><a class="reference internal" href="#neuralop.losses.H1Loss.compute_terms"><code class="docutils literal notranslate"><span class="pre">H1Loss.compute_terms()</span></code></a></li>
<li><a class="reference internal" href="#neuralop.losses.H1Loss.uniform_quadrature"><code class="docutils literal notranslate"><span class="pre">H1Loss.uniform_quadrature()</span></code></a></li>
<li><a class="reference internal" href="#neuralop.losses.H1Loss.reduce_all"><code class="docutils literal notranslate"><span class="pre">H1Loss.reduce_all()</span></code></a></li>
<li><a class="reference internal" href="#neuralop.losses.H1Loss.abs"><code class="docutils literal notranslate"><span class="pre">H1Loss.abs()</span></code></a></li>
<li><a class="reference internal" href="#neuralop.losses.H1Loss.rel"><code class="docutils literal notranslate"><span class="pre">H1Loss.rel()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    </aside>
    </div>

  

  </div>  
  </div> 

  
  <script>
    function toggle_sidebar() {
        var element = document.getElementById("sidebar");
        var container = document.getElementById("column-container");
        var localtoccolumn = document.getElementById("localtoc-column");
        element.classList.toggle("hide-tablet");
        element.classList.toggle("is-hidden-mobile");
        container.classList.toggle("sidemenu-hidden");
        localtoccolumn.classList.toggle("is-one-fifth-widescreen");
        localtoccolumn.classList.toggle("is-2-desktop");
        localtoccolumn.classList.toggle("is-3-desktop");
    }
  </script> 



  </body>
</html>