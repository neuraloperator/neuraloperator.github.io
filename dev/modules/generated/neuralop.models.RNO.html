<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>neuralop.models.RNO &#8212; neuraloperator 2.0.0 documentation</title> 
<link rel="stylesheet" href="../../_static/tensorly_style.css">
<link rel="apple-touch-icon" sizes="180x180" href="../../_static/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../_static/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../_static/favicon/favicon-16x16.png">
<link rel="manifest" href="../../_static/favicon/site.webmanifest">
<link rel="mask-icon" href="../../_static/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../../_static/favicon/favicon.ico">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/tensorly_style.css?v=a02e9698" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=5126dfd5" />

  
    <script src="../../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
 <script src="../../_static/navbar_burger.js"></script>
 <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
 
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="neuralop.models.UQNO" href="neuralop.models.UQNO.html" />
    <link rel="prev" title="neuralop.models.UNO" href="neuralop.models.UNO.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  </head>
<body  class="has-navbar-fixed-top">

  <header>
    <navbar>
      <nav class="navbar top-navbar is-fixed-top has-shadow is-flex-wrap-wrap" role="navigation" aria-label="main top navigation">
        <div class="navbar-brand">
        

          <a class="navbar-item" href="../../index.html">
            <img src="../../_static/neuraloperator_logo.png" height="28">
          </a>
          <a class="navbar-item is-hidden-desktop" href="https://github.com/neuraloperator/neuraloperator" target="_blank">
              <span class="icon"><i class="fab fa-github"></i></span>
          </a>

          <a role="button" class="navbar-burger" data-target="top-nav-menu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>

        </div>
        
        <div class="navbar-menu" id="top-nav-menu">
        

          <div class="navbar-start">
            
              <a class="navbar-item" href="../../install.html">
              Install
            </a>
              <a class="navbar-item" href="../../theory_guide/index.html">
              Theory Guide
            </a>
              <a class="navbar-item" href="../../user_guide/index.html">
              User Guide
            </a>
              <a class="navbar-item" href="../api.html">
              API
            </a>
              <a class="navbar-item" href="../../auto_examples/index.html">
              Examples
            </a>
              <a class="navbar-item" href="../../dev_guide/index.html">
              Developer's Guide
            </a>
          </div>
        
          <div class="navbar-end">
            <div class="navbar-item">
            
            <a class="button is-hidden-touch is-dark" href="https://github.com/neuraloperator/neuraloperator" target="_blank">
              <span class="icon-text">
                <span class="icon is-large">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </span>
            </a>

            </div> 
          </div> 
        </div> 

      </nav>
      
    </navbar>
  </header>


  <div id="column-container">
  <div class="columns is-mobile is-centered">
	
  
      <div class="column is-10-mobile is-one-third-tablet is-3-desktop is-hidden-mobile" id="sidebar">
    
    <aside class="sticky-nav sidebar-menu">
<div class="sidebar-search">
  <form class="field" id="searchbox" role="search" action="../../search.html" method="get">
    <!-- <label class="label" id="searchlabel">Quick search</label> -->
    <div class="field has-addons">
      <div class="control is-expanded">
        <input class="input" type="text" placeholder="Search the doc" name="q" aria-labelledby="searchlabel autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      </div>
      <div class="control">
        <input class="button is-info" type="submit" value="Go" />
      </div>
    </div>
  </form>
  <script>document.getElementById('searchbox').style.display = "block"</script>

</div>
      
      <div class="sidebar-menu-toc">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing NeuralOperator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory_guide/index.html">Theory Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-neuralop.layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#model-dispatching">Model Dispatching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#loss-functions">Loss Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#data">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-neuralop.utils">Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_guide/index.html">Development guide</a></li>
</ul>
 
      </div>
    </aside>
  </div>
  

  <div class="column main-column">

    
    <div class="main-section">

      
      
      <div class="side-menu-toggle">
        <button class="button" id="toggle-sidebar" onclick="toggle_sidebar()">
          <span class="icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
          <span>menu</span> 
        </button>
      </div>
      

      <div class="container content main-content">
        
  <section id="neuralop-models-rno">
<h1><a class="reference internal" href="../api.html#module-neuralop.models" title="neuralop.models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.models</span></code></a>.RNO<a class="headerlink" href="#neuralop-models-rno" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="neuralop.models.RNO">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralop.models.</span></span><span class="sig-name descname"><span class="pre">RNO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/models/rno.html#RNO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.models.RNO" title="Link to this definition"></a></dt>
<dd><p>N-Dimensional Recurrent Neural Operator.</p>
<p>The RNO has an identical architecture to the finite-dimensional GRU, with
the exception that linear matrix-vector multiplications are replaced by
Fourier layers (Li et al., 2021), and for regression problems, the output
nonlinearity is replaced by a SELU activation.</p>
<p>The operation of the GRU is as follows:
z_t = sigmoid(W_z x + U_z h_{t-1} + b_z)
r_t = sigmoid(W_r x + U_r h_{t-1} + b_r)
hat h_t = selu(W_h x_t + U_h (r_t * h_{t-1}) + b_h)
h_t = (1 - z_t) * h_{t-1} + z_t * hat h_t,</p>
<p>where * is element-wise, the b_i’s are bias functions, and W_i, U_i are
linear Fourier layers.</p>
<p>Paper:
.. [R943463ff80d7-RNO] Liu-Schiaffini, M., Singer, C. E., Kovachki, N., Schneider, T.,</p>
<blockquote>
<div><p>Azizzadenesheli, K., &amp; Anandkumar, A. (2023). Tipping point forecasting 
in non-stationary dynamics on function spaces. arXiv preprint 
arXiv:2308.08794.</p>
</div></blockquote>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuralop.models.RNO.forward" title="neuralop.models.RNO.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x[, init_hidden_states, ...])</p></td>
<td><p>Forward pass for the Recurrent Neural Operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuralop.models.RNO.predict" title="neuralop.models.RNO.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(x, num_steps[, grid_function])</p></td>
<td><p>Autoregressively predict future time steps.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="neuralop.models.RNO.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_hidden_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_hidden_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_states_padded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/models/rno.html#RNO.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.models.RNO.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass for the Recurrent Neural Operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">torch.Tensor</span></dt><dd><p>Input tensor with shape (batch, timesteps, in_channels, <a href="#id1"><span class="problematic" id="id2">*</span></a>spatial_dims),
where len(spatial_dims) == self.n_dim. The channel dimension MUST be at
index 2 and the time dimension MUST be at index 1.</p>
</dd>
<dt><strong>init_hidden_states</strong><span class="classifier">list[torch.Tensor] | None</span></dt><dd><p>Optional list of per-layer initial hidden states. Each tensor should have
shape (batch, hidden_channels, <a href="#id3"><span class="problematic" id="id4">*</span></a>spatial_dims_h), where spatial_dims_h are
the unpadded spatial dimensions at each layer (accounting for resolution
scaling). If domain_padding is enabled, hidden states will be automatically
padded like the input x, unless keep_states_padded is True.
If None, all hidden states are initialized internally.</p>
</dd>
<dt><strong>return_hidden_states</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to return the final hidden states for each layer in addition to
the prediction. Default: False</p>
</dd>
<dt><strong>keep_states_padded</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, treats provided init_hidden_states as already padded (no additional
padding applied) and returns final_hidden_states in padded form (no unpadding).
Use this for efficient autoregressive loops to preserve boundary information.
Default: False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pred</strong><span class="classifier">torch.Tensor</span></dt><dd><p>Output tensor with shape (batch, out_channels, <a href="#id5"><span class="problematic" id="id6">*</span></a>spatial_dims_out).</p>
</dd>
<dt><strong>final_hidden_states</strong><span class="classifier">list[torch.Tensor], optional</span></dt><dd><p>Returned only if return_hidden_states=True.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralop.models.RNO.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/models/rno.html#RNO.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.models.RNO.predict" title="Link to this definition"></a></dt>
<dd><p>Autoregressively predict future time steps.</p>
<p>Performs autoregressive rollout by iteratively feeding predictions back as input.
At each step, the model predicts the next time step from the current input,
then uses that prediction as input for the subsequent prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">torch.Tensor</span></dt><dd><p>Initial input sequence with shape (batch, timesteps, in_channels, <a href="#id7"><span class="problematic" id="id8">*</span></a>spatial_dims).
The last time step of this sequence serves as the starting point for predictions.</p>
</dd>
<dt><strong>num_steps</strong><span class="classifier">int</span></dt><dd><p>Number of future time steps to predict autoregressively.</p>
</dd>
<dt><strong>grid_function</strong><span class="classifier">callable, optional</span></dt><dd><p>Function that generates positional embeddings (e.g., spatial coordinates) to
concatenate with predictions before feeding them back as input. Should have
signature grid_function(shape, device) -&gt; torch.Tensor, where the returned
tensor has shape matching the input requirements. Use this when your model
was trained with concatenated positional information. Default: None</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>torch.Tensor</dt><dd><p>Predicted sequence with shape (batch, num_steps, out_channels, <a href="#id9"><span class="problematic" id="id10">*</span></a>spatial_dims),
containing the autoregressively generated future states.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method maintains hidden states across prediction steps, enabling the RNO
to leverage its recurrent structure during autoregressive generation.</p>
</dd></dl>

</dd></dl>

<div class="clearer"></div></section>


      </div>

      
        <nav class="pagination" role="navigation" aria-label="pagination">
    
    <a class="button pagination-previous" href="neuralop.models.UNO.html" title="previous page" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.models</span></code>.UNO</span>
    </a>
    
    
    <a class="button pagination-next" href="neuralop.models.UQNO.html" title="next page" accesskey="n">
        <span><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.models</span></code>.UQNO </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

      

        <footer class="footer">
    <div class="content has-text-centered">
        <div class="block">
          &copy; Copyright 2026, Jean Kossaifi, David Pitt, Nikola Kovachki, Zongyi Li and Anima Anandkumar.<br/>
        </div>
    </div>
  </footer>

    </div>

  </div>  

	
    
    <div class="column is-hidden-touch is-2-desktop is-one-fifth-widescreen" id="localtoc-column">

    <aside class="sticky-nav localtoc"> 
        <p class="menu-label"> 
            <span class="icon-text">
                <span class="icon"><i class="fas fa-duotone fa-list"></i></span>
                <span> On this page </span>
            </span>
        </p>

        <div class="menu menu-list localtoc-list">
        <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.models</span></code>.RNO</a><ul>
<li><a class="reference internal" href="#neuralop.models.RNO"><code class="docutils literal notranslate"><span class="pre">RNO</span></code></a><ul>
<li><a class="reference internal" href="#neuralop.models.RNO.forward"><code class="docutils literal notranslate"><span class="pre">RNO.forward()</span></code></a></li>
<li><a class="reference internal" href="#neuralop.models.RNO.predict"><code class="docutils literal notranslate"><span class="pre">RNO.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    </aside>
    </div>

  

  </div>  
  </div> 

  
  <script>
    function toggle_sidebar() {
        var element = document.getElementById("sidebar");
        var container = document.getElementById("column-container");
        var localtoccolumn = document.getElementById("localtoc-column");
        element.classList.toggle("hide-tablet");
        element.classList.toggle("is-hidden-mobile");
        container.classList.toggle("sidemenu-hidden");
        localtoccolumn.classList.toggle("is-one-fifth-widescreen");
        localtoccolumn.classList.toggle("is-2-desktop");
        localtoccolumn.classList.toggle("is-3-desktop");
    }
  </script> 



  </body>
</html>