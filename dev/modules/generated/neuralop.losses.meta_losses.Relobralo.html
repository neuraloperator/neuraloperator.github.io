<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>neuralop.losses.meta_losses.Relobralo &#8212; neuraloperator 1.0.2 documentation</title> 
<link rel="stylesheet" href="../../_static/tensorly_style.css">
<link rel="apple-touch-icon" sizes="180x180" href="../../_static/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../_static/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../_static/favicon/favicon-16x16.png">
<link rel="manifest" href="../../_static/favicon/site.webmanifest">
<link rel="mask-icon" href="../../_static/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../../_static/favicon/favicon.ico">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/tensorly_style.css?v=a02e9698" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=5126dfd5" />

  
    <script src="../../_static/documentation_options.js?v=1ed6394b"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
 <script src="../../_static/navbar_burger.js"></script>
 <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
 
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="neuralop.losses.meta_losses.SoftAdapt" href="neuralop.losses.meta_losses.SoftAdapt.html" />
    <link rel="prev" title="neuralop.losses.meta_losses.WeightedSumLoss" href="neuralop.losses.meta_losses.WeightedSumLoss.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  </head>
<body  class="has-navbar-fixed-top">

  <header>
    <navbar>
      <nav class="navbar top-navbar is-fixed-top has-shadow is-flex-wrap-wrap" role="navigation" aria-label="main top navigation">
        <div class="navbar-brand">
        

          <a class="navbar-item" href="../../index.html">
            <img src="../../_static/neuraloperator_logo.png" height="28">
          </a>
          <a class="navbar-item is-hidden-desktop" href="https://github.com/neuraloperator/neuraloperator" target="_blank">
              <span class="icon"><i class="fab fa-github"></i></span>
          </a>

          <a role="button" class="navbar-burger" data-target="top-nav-menu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>

        </div>
        
        <div class="navbar-menu" id="top-nav-menu">
        

          <div class="navbar-start">
            
              <a class="navbar-item" href="../../install.html">
              Install
            </a>
              <a class="navbar-item" href="../../theory_guide/index.html">
              Theory Guide
            </a>
              <a class="navbar-item" href="../../user_guide/index.html">
              User Guide
            </a>
              <a class="navbar-item" href="../api.html">
              API
            </a>
              <a class="navbar-item" href="../../auto_examples/index.html">
              Examples
            </a>
              <a class="navbar-item" href="../../dev_guide/index.html">
              Developer's Guide
            </a>
          </div>
        
          <div class="navbar-end">
            <div class="navbar-item">
            
            <a class="button is-hidden-touch is-dark" href="https://github.com/neuraloperator/neuraloperator" target="_blank">
              <span class="icon-text">
                <span class="icon is-large">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </span>
            </a>

            </div> 
          </div> 
        </div> 

      </nav>
      
    </navbar>
  </header>


  <div id="column-container">
  <div class="columns is-mobile is-centered">
	
  
      <div class="column is-10-mobile is-one-third-tablet is-3-desktop is-hidden-mobile" id="sidebar">
    
    <aside class="sticky-nav sidebar-menu">
<div class="sidebar-search">
  <form class="field" id="searchbox" role="search" action="../../search.html" method="get">
    <!-- <label class="label" id="searchlabel">Quick search</label> -->
    <div class="field has-addons">
      <div class="control is-expanded">
        <input class="input" type="text" placeholder="Search the doc" name="q" aria-labelledby="searchlabel autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      </div>
      <div class="control">
        <input class="button is-info" type="submit" value="Go" />
      </div>
    </div>
  </form>
  <script>document.getElementById('searchbox').style.display = "block"</script>

</div>
      
      <div class="sidebar-menu-toc">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing NeuralOperator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory_guide/index.html">Theory Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-neuralop.layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#model-dispatching">Model Dispatching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#training">Training</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#loss-functions">Loss Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#data">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-neuralop.utils">Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_guide/index.html">Development guide</a></li>
</ul>
 
      </div>
    </aside>
  </div>
  

  <div class="column main-column">

    
    <div class="main-section">

      
      
      <div class="side-menu-toggle">
        <button class="button" id="toggle-sidebar" onclick="toggle_sidebar()">
          <span class="icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
          <span>menu</span> 
        </button>
      </div>
      

      <div class="container content main-content">
        
  <section id="neuralop-losses-meta-losses-relobralo">
<h1><a class="reference internal" href="../api.html#module-neuralop.losses.meta_losses" title="neuralop.losses.meta_losses"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.losses.meta_losses</span></code></a>.Relobralo<a class="headerlink" href="#neuralop-losses-meta-losses-relobralo" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="neuralop.losses.meta_losses.Relobralo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralop.losses.meta_losses.</span></span><span class="sig-name descname"><span class="pre">Relobralo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neuralop/losses/meta_losses.html#Relobralo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.meta_losses.Relobralo" title="Link to this definition"></a></dt>
<dd><p>Relative Loss Balancing with Random Lookback (ReLoBRaLo) algorithm for adaptive loss weighting.</p>
<p>ReLoBRaLo combines relative loss balancing with random lookback to provide more
stable and effective multi-objective optimization. The algorithm uses both
initial loss values and previous loss values to compute adaptive weights,
with a random lookback mechanism. This random lookback mechanism introduces
stochasticity in the weighting by sometimes reverting to initial loss values,
encouraging robustness across loss scales over time.</p>
<p>Reference: “Bischof, R. and Kraus, M., 2021.
Multi-Objective Loss Balancing for Physics-Informed Deep Learning.
arXiv preprint arXiv:2110.09813.”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">List[torch.Tensor]</span></dt><dd><p>List of model parameters used to determine the device for tensor operations.</p>
</dd>
<dt><strong>num_losses</strong><span class="classifier">int</span></dt><dd><p>Number of loss components that will be aggregated.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float, optional</span></dt><dd><p>Controls the smoothing factor for the exponential moving average of the adaptive weights.
High alpha gives more inertia to past weights (more stability).
Low alpha allows faster adaptation.
By default 0.95</p>
</dd>
<dt><strong>beta</strong><span class="classifier">float, optional</span></dt><dd><p>Probability for the random lookback mechanism, i.e. probability of sampling from
initial loss values instead of previous loss values during adaptive weight computation.
By default 0.99</p>
</dd>
<dt><strong>tau</strong><span class="classifier">float, optional</span></dt><dd><p>Temperature parameter that controls the sharpness of the exponential
weighting. Higher values make the weights more uniform, by default 1.0</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float, optional</span></dt><dd><p>Small constant added to denominators to prevent division by zero.
Should be positive and small (e.g., 1e-8), by default 1e-8.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">Optional[Dict[str, float]], optional</span></dt><dd><p>Optional static weights for each loss component, by default None</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuralop.losses.meta_losses.Relobralo.forward" title="neuralop.losses.meta_losses.Relobralo.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(losses, step)</p></td>
<td><p>Weights and aggregates the losses using the ReLoBRaLo algorithm.</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The algorithm assumes that all loss components should be minimized. If some
losses should be maximized, they should be negated before passing to ReLoBRaLo.</p>
<p>The random component means that results may vary between runs,
due to the Bernoulli sampling in the weight computation.</p>
</div>
<p class="rubric">Notes</p>
<p>At step 0, all losses are simply summed with equal weights, and both initial
and previous loss buffers are initialized with the current loss values.</p>
<p>The random lookback mechanism (controlled by beta) helps the algorithm escape
local minima by occasionally using initial loss values instead of recent ones.
This is particularly useful in physics-informed neural networks where different
loss components may have different convergence characteristics.</p>
<p>The temperature parameter tau controls how aggressive the weighting is. Lower
values make the algorithm more selective in which losses to prioritize,
while higher values make the weights more uniform.</p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralop.losses.meta_losses.Relobralo.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">losses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../_modules/neuralop/losses/meta_losses.html#Relobralo.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralop.losses.meta_losses.Relobralo.forward" title="Link to this definition"></a></dt>
<dd><p>Weights and aggregates the losses using the ReLoBRaLo algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>losses</strong><span class="classifier">Dict[str, torch.Tensor]</span></dt><dd><p>Dictionary of loss components to be aggregated.
For instance, the keys could be ‘data_loss’ and ‘physics_loss’.</p>
</dd>
<dt><strong>step</strong><span class="classifier">int</span></dt><dd><p>Current optimization step. Used to determine whether to initialize
the algorithm (step 0) or apply adaptive weighting (step &gt; 0).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>loss</strong><span class="classifier">torch.Tensor</span></dt><dd><p>The aggregated loss value.</p>
</dd>
<dt><strong>lmbda_ema</strong><span class="classifier">torch.Tensor</span></dt><dd><p>The exponential moving average of adaptive weights for each loss component.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>At step 0, all losses are summed with equal weights, and both initial
and previous loss buffers are initialized with the current loss values.</p>
<p>For subsequent steps, the algorithm computes weights using both initial
and previous loss values, with a random component that helps escape
local minima. The final weights are computed as an exponential moving average.</p>
</dd></dl>

</dd></dl>

<div class="clearer"></div></section>


      </div>

      
        <nav class="pagination" role="navigation" aria-label="pagination">
    
    <a class="button pagination-previous" href="neuralop.losses.meta_losses.WeightedSumLoss.html" title="previous page" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.losses.meta_losses</span></code>.WeightedSumLoss</span>
    </a>
    
    
    <a class="button pagination-next" href="neuralop.losses.meta_losses.SoftAdapt.html" title="next page" accesskey="n">
        <span><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.losses.meta_losses</span></code>.SoftAdapt </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

      

        <footer class="footer">
    <div class="content has-text-centered">
        <div class="block">
          &copy; Copyright 2025, Jean Kossaifi, David Pitt, Nikola Kovachki, Zongyi Li and Anima Anandkumar.<br/>
        </div>
    </div>
  </footer>

    </div>

  </div>  

	
    
    <div class="column is-hidden-touch is-2-desktop is-one-fifth-widescreen" id="localtoc-column">

    <aside class="sticky-nav localtoc"> 
        <p class="menu-label"> 
            <span class="icon-text">
                <span class="icon"><i class="fas fa-duotone fa-list"></i></span>
                <span> On this page </span>
            </span>
        </p>

        <div class="menu menu-list localtoc-list">
        <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neuralop.losses.meta_losses</span></code>.Relobralo</a><ul>
<li><a class="reference internal" href="#neuralop.losses.meta_losses.Relobralo"><code class="docutils literal notranslate"><span class="pre">Relobralo</span></code></a><ul>
<li><a class="reference internal" href="#neuralop.losses.meta_losses.Relobralo.forward"><code class="docutils literal notranslate"><span class="pre">Relobralo.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    </aside>
    </div>

  

  </div>  
  </div> 

  
  <script>
    function toggle_sidebar() {
        var element = document.getElementById("sidebar");
        var container = document.getElementById("column-container");
        var localtoccolumn = document.getElementById("localtoc-column");
        element.classList.toggle("hide-tablet");
        element.classList.toggle("is-hidden-mobile");
        container.classList.toggle("sidemenu-hidden");
        localtoccolumn.classList.toggle("is-one-fifth-widescreen");
        localtoccolumn.classList.toggle("is-2-desktop");
        localtoccolumn.classList.toggle("is-3-desktop");
    }
  </script> 



  </body>
</html>